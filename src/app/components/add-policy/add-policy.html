<div class="container">
  <div class="card">
    <h2>Add Policy</h2>

    @if (submitSuccess()) {
      <div class="alert alert-success">Policy added successfully!</div>
    }

    @if (submitError()) {
      <div class="alert alert-error">{{ submitError() }}</div>
    }

    <!-- Policy Number -->
    <div class="form-group">
      <label>Policy Number *</label>
      <input
        type="text"
        [value]="policyNumber()"
        (input)="policyNumber.set($any($event.target).value)"
        [class.error]="policyNumberError()"
      />
      @if (policyNumberError()) {
        <div class="error-message">{{ policyNumberError() }}</div>
      }
    </div>

    <!-- Holder Name -->
    <div class="form-group">
      <label>Policy Holder Name *</label>
      <input
        type="text"
        [value]="policyHolderName()"
        (input)="policyHolderName.set($any($event.target).value)"
        [class.error]="nameError()"
      />
      @if (nameError()) {
        <div class="error-message">{{ nameError() }}</div>
      }
    </div>

    <!-- Type -->
    <div class="form-group">
      <label>Policy Type *</label>
      <select
        [value]="policyType()"
        (change)="policyType.set($any($event.target).value)">
        <option value="">Select Type</option>
        @for (type of policyTypes(); track type) {
          <option [value]="type">{{ type }}</option>
        }
      </select>
    </div>

    <!-- Premium -->
    <div class="form-group">
      <label>Premium *</label>
      <input
        type="number"
        [value]="premium()"
        (input)="premium.set(+$any($event.target).value)"
        [class.error]="premiumError()"
      />
      @if (premiumError()) {
        <div class="error-message">{{ premiumError() }}</div>
      }
    </div>

    <!-- Dates -->
    <div class="form-group">
      <label>Start Date *</label>
      <input type="date" (change)="startDate.set($any($event.target).value)" />
    </div>

    <div class="form-group">
      <label>End Date *</label>
      <input type="date" (change)="endDate.set($any($event.target).value)" />
    </div>

    <!-- Status -->
    <div class="form-group">
      <label>Status</label>
      <select
        [value]="status()"
        (change)="status.set($any($event.target).value)">
        @for (s of statuses(); track s) {
          <option [value]="s">{{ s }}</option>
        }
      </select>
    </div>

    <!-- Actions -->
    <div class="button-group">
      <button
        class="btn btn-primary"
        [disabled]="!isFormValid() || isSubmitting()"
        (click)="onSubmit()">
        @if (isSubmitting()) { Adding... } @else { Add Policy }
      </button>

      <button class="btn btn-secondary" routerLink="/view-policies">
        Cancel
      </button>
    </div>
  </div>
</div>
